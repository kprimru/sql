USE [SaleDB]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF OBJECT_ID('[Client].[CompanyRivalView]', 'V ') IS NULL EXEC('CREATE VIEW [Client].[CompanyRivalView]  AS SELECT 1')
GO
ALTER VIEW [Client].[CompanyRivalView]
AS
	SELECT ID
	FROM
		(
			SELECT ID, ROW_NUMBER() OVER(PARTITION BY ID_COMPANY ORDER BY INFO_DATE DESC, BDATE DESC) AS RN
			FROM Client.CompanyRival
			WHERE STATUS = 1
		) AS o_O
	WHERE RN = 1
GO
