USE [SaleDB]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [Memo].[CLIENT_MEMO_CONDITION_SAVE]
	@ID			UNIQUEIDENTIFIER,
	@CONDITION	NVARCHAR(MAX)
AS
BEGIN
	SET NOCOUNT ON;

	INSERT INTO Memo.ClientMemoConditions(ID_MEMO, CONDITION, ORD)
		SELECT
			@ID, @CONDITION,
			ISNULL(
				(
					SELECT MAX(ORD) + 1
					FROM Memo.ClientMemoConditions
					WHERE ID_MEMO = @ID
				), 1)
END
GRANT EXECUTE ON [Memo].[CLIENT_MEMO_CONDITION_SAVE] TO rl_client_memo_w;
GO