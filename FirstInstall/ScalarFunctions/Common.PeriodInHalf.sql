USE [FirstInstall]
	GO
	SET ANSI_NULLS ON
	GO
	SET QUOTED_IDENTIFIER ON
	GO
	CREATE FUNCTION [Common].[PeriodInHalf]
(
	@PR_ID	UNIQUEIDENTIFIER,
	@HLF_ID	UNIQUEIDENTIFIER
)
RETURNS BIT
AS
BEGIN	
	DECLARE @RESULT BIT

	IF EXISTS
		(
			SELECT *
			FROM 
				Common.PeriodLast,
				Common.HalfLast
			WHERE PR_ID_MASTER = @PR_ID 
				AND HLF_ID_MASTER = @HLF_ID
				AND PR_BEGIN_DATE >= HLF_BEGIN_DATE
				AND PR_END_DATE <= HLF_END_DATE
		)
	BEGIN
		SET @RESULT = 1
	END
	ELSE
	BEGIN
		SET @RESULT = 0
	END

	RETURN @RESULT
END
