USE [FirstInstall]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF OBJECT_ID('[Common].[LOCK_RELEASE]', 'P ') IS NULL EXEC('CREATE PROCEDURE [Common].[LOCK_RELEASE]  AS SELECT 1')
GO
ALTER PROCEDURE [Common].[LOCK_RELEASE]
	@docid	VARCHAR(MAX),
	@dataid	UNIQUEIDENTIFIER
AS
BEGIN
	SET NOCOUNT ON;

	DELETE
	FROM Common.Locks
	WHERE LC_ID_DATA = @dataid
		AND LC_RECORD IN
		(
			SELECT	ID
			FROM	Common.TableFromList(@docid, ',')
		)
END
GO
GRANT EXECUTE ON [Common].[LOCK_RELEASE] TO public;
GO
