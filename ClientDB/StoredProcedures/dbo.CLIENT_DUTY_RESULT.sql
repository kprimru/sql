USE [ClientDB]
	GO
	SET ANSI_NULLS ON
	GO
	SET QUOTED_IDENTIFIER ON
	GO
	CREATE PROCEDURE [dbo].[CLIENT_DUTY_RESULT]
	@DUTY		INT,
	@ANS		TINYINT,
	@ANS_NOTE	NVARCHAR(MAX),
	@SAT		TINYINT,
	@SAT_NOTE	NVARCHAR(MAX)
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @ID UNIQUEIDENTIFIER
	
	SELECT @ID = ID
	FROM dbo.ClientDutyResult
	WHERE ID_DUTY = @DUTY
	
	IF @ID IS NULL
		INSERT INTO dbo.ClientDutyResult(ID_DUTY, ANSWER, ANSWER_NOTE, SATISF, SATISF_NOTE)
			VALUES(@DUTY, @ANS, @ANS_NOTE, @SAT, @SAT_NOTE)
	ELSE
		UPDATE dbo.ClientDutyResult
		SET ANSWER = @ANS,
			ANSWER_NOTE = @ANS_NOTE,
			SATISF = @SAT,
			SATISF_NOTE = @SAT_NOTE
		WHERE ID = @ID
END
